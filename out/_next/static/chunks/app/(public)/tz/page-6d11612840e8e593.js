(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[734],{3215:function(e,a,s){Promise.resolve().then(s.bind(s,3842))},3842:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return h}});var n=s(7437),t=s(2265);let c={BOT_TOKEN:"8304590877:AAEfblij32-TzdrBtCa4HNEyTu84ADUW4wY",CHAT_ID:"572193621",API_URL:"https://api.telegram.org/bot"},o=e=>e?String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):"",i=async e=>{try{let a=await fetch("".concat(c.API_URL).concat(c.BOT_TOKEN,"/sendMessage"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:c.CHAT_ID,text:e,parse_mode:"HTML"})});if(!a.ok){let e=(await a.json().catch(()=>({}))).description||"HTTP error! status: ".concat(a.status);throw Error(e)}let s=await a.json();return{success:!0,data:s}}catch(e){return{success:!1,error:e.message}}},l=e=>{let{objectType:a,totalArea:s,roomsCount:n,selectedRooms:t,roomParams:c}=e,i={"living-room":"Гостиная",kitchen:"Кухня",bedroom:"Спальня",bathroom:"Ванная",toilet:"Туалет",hallway:"Прихожая",balcony:"Балкон","dressing-room":"Гардеробная"};t.map(e=>i[e]||e);let l="";t.length>0&&(l=t.map(e=>{var a,s,n,t;let l=i[e]||e,r=c[e]||{},d=(null===(a=r.length)||void 0===a?void 0:a.toString())||"0",m=(null===(s=r.width)||void 0===s?void 0:s.toString())||"0",u=(null===(n=r.height)||void 0===n?void 0:n.toString())||"0",h=(null===(t=r.area)||void 0===t?void 0:t.toString())||"0.0";return"• ".concat(o(l),": ").concat(o(h)," м\xb2 (").concat(o(d),"\xd7").concat(o(m),"\xd7").concat(o(u)," м)")}).join("\n"));let r="";t.length>0&&(r=t.map(e=>{var a,s,n,t;let l=i[e]||e,r=c[e]||{},d=(null===(a=r.length)||void 0===a?void 0:a.toString())||"0",m=(null===(s=r.width)||void 0===s?void 0:s.toString())||"0",u=(null===(n=r.height)||void 0===n?void 0:n.toString())||"0",h=(null===(t=r.area)||void 0===t?void 0:t.toString())||"0.0",b=o(r.purpose||"Не указано"),p=o(r.requirements||"Не указаны");return"\n\uD83C\uDFE0 <b>".concat(o(l),"</b>:\n\uD83D\uDCD0 Размеры: ").concat(o(d)," \xd7 ").concat(o(m)," \xd7 ").concat(o(u)," м\n\uD83D\uDCCF Площадь: ").concat(o(h)," м\xb2\n\uD83C\uDFAF Назначение: ").concat(b,"\n⚙️ Требования: ").concat(p)}).join("\n"));let d=t.reduce((e,a)=>{var s;return e+(parseFloat((null===(s=(c[a]||{}).area)||void 0===s?void 0:s.toString())||"0")||0)},0).toFixed(1),m=o({apartment:"Квартира",studio:"Студия",house:"Частный дом",commercial:"Коммерция"}[a]||a),u=new Date().toLocaleString("ru-RU"),h="\uD83C\uDFE0 <b>ЭКСПЛИКАЦИЯ ПОМЕЩЕНИЙ ПО ГОСТ 21.501-2018</b>\n\n\uD83D\uDCCB <b>Тип объекта:</b> ".concat(m,"\n\uD83D\uDCD0 <b>Общая площадь:</b> ").concat(o(d)," м\xb2\n\uD83D\uDEAA <b>Количество комнат:</b> ").concat(o(n),"\n\n\uD83D\uDCCA <b>КРАТКАЯ СВОДКА:</b>\n").concat(l||"• Данные не заполнены","\n\n\uD83D\uDCCB <b>ПОДРОБНАЯ ИНФОРМАЦИЯ О ПОМЕЩЕНИЯХ:</b>").concat(r||"\n• Данные не заполнены","\n\n\uD83D\uDCC8 <b>ИТОГО:</b> ").concat(o(d)," м\xb2\n\n\uD83D\uDCC5 <b>Дата создания:</b> ").concat(o(u),"\n\uD83D\uDD17 <b>Источник:</b> Дизайн360 - Экспликация помещений").trim();if(h.length>4096){let e=t.map(e=>{var a;let s=i[e]||e,n=(null===(a=(c[e]||{}).area)||void 0===a?void 0:a.toString())||"0.0";return"• ".concat(o(s),": ").concat(o(n)," м\xb2")}).join("\n");return"\uD83C\uDFE0 <b>ЭКСПЛИКАЦИЯ ПОМЕЩЕНИЙ ПО ГОСТ 21.501-2018</b>\n\n\uD83D\uDCCB <b>Тип объекта:</b> ".concat(m,"\n\uD83D\uDCD0 <b>Общая площадь:</b> ").concat(o(d)," м\xb2\n\uD83D\uDEAA <b>Количество комнат:</b> ").concat(o(n),"\n\n\uD83D\uDCCA <b>СВОДКА:</b>\n").concat(e||"• Данные не заполнены","\n\n\uD83D\uDCC8 <b>ИТОГО:</b> ").concat(o(d)," м\xb2\n\n\uD83D\uDCC5 <b>Дата создания:</b> ").concat(o(u),"\n\uD83D\uDD17 <b>Источник:</b> Дизайн360 - Экспликация помещений").trim()}return h},r=async e=>{try{let a=l(e),s=await i(a);if(s.success)return{success:!0,message:"Заявка успешно отправлена! Мы свяжемся с вами в ближайшее время."};throw Error(s.error)}catch(e){return{success:!1,message:"Произошла ошибка при отправке заявки. Попробуйте еще раз или свяжитесь с нами напрямую."}}};s(9419);let d=[{id:"apartment",icon:"\uD83C\uDFE2",name:"Квартира",description:"Жилое помещение"},{id:"studio",icon:"\uD83C\uDFD8️",name:"Студия",description:"Открытое пространство"},{id:"house",icon:"\uD83C\uDFE0",name:"Частный дом",description:"Индивидуальное жилье"},{id:"commercial",icon:"\uD83C\uDFEA",name:"Коммерция",description:"Офис, магазин, кафе"}],m=[{id:"living-room",icon:"\uD83D\uDECB️",name:"Гостиная"},{id:"kitchen",icon:"\uD83C\uDF73",name:"Кухня"},{id:"bedroom",icon:"\uD83D\uDECF️",name:"Спальня"},{id:"bathroom",icon:"\uD83D\uDEBF",name:"Ванная"},{id:"toilet",icon:"\uD83D\uDEBD",name:"Туалет"},{id:"hallway",icon:"\uD83D\uDEAA",name:"Прихожая"},{id:"balcony",icon:"\uD83C\uDF24️",name:"Балкон"},{id:"dressing-room",icon:"\uD83D\uDC54",name:"Гардеробная"}],u={"living-room":"Гостиная",kitchen:"Кухня",bedroom:"Спальня",bathroom:"Ванная",toilet:"Туалет",hallway:"Прихожая",balcony:"Балкон","dressing-room":"Гардеробная"};function h(){let{formData:e,currentStep:a,errors:s,isSubmitting:c,validationAttempts:o,updateFormData:i,updateRoomParams:l,toggleRoom:h,selectAllRooms:b,resetRoomParams:p,nextStep:v,prevStep:D,goToStep:j,validateAllSteps:x,setSubmitting:C,getStepAccessibility:N}=function(){let[e,a]=(0,t.useState)({objectType:"",totalArea:"",roomsCount:"",selectedRooms:[],roomParams:{}}),[s,n]=(0,t.useState)(1),[c,o]=(0,t.useState)({}),[i,l]=(0,t.useState)(!1),[r,d]=(0,t.useState)(0),m=(0,t.useCallback)(e=>{a(a=>({...a,...e}))},[]),u=(0,t.useCallback)((e,s,n)=>{a(a=>({...a,roomParams:{...a.roomParams,[e]:{...a.roomParams[e],[s]:n}}}))},[]),h=(0,t.useCallback)(e=>{a(a=>{let s=a.selectedRooms.includes(e);return{...a,selectedRooms:s?a.selectedRooms.filter(a=>a!==e):[...a.selectedRooms,e]}})},[]),b=(0,t.useCallback)(()=>{let e=["living-room","bedroom","kitchen","bathroom","hallway","balcony"];a(a=>({...a,selectedRooms:e}))},[]),p=(0,t.useCallback)(()=>{a(e=>({...e,roomParams:{}}))},[]),v=(0,t.useCallback)(()=>{x()?(n(e=>Math.min(e+1,4)),o({})):d(e=>e+1)},[s,e]),D=(0,t.useCallback)(()=>{n(e=>Math.max(e-1,1)),o({})},[]),j=(0,t.useCallback)(e=>{(e<=s||C(e-1))&&(n(e),o({}))},[s]),x=(0,t.useCallback)(()=>{let a={};return 1!==s||(e.objectType||(a.objectType="Выберите тип объекта"),e.totalArea||(a.totalArea="Укажите общую площадь"),e.roomsCount||(a.roomsCount="Укажите количество комнат")),2===s&&0===e.selectedRooms.length&&(a.selectedRooms="Выберите хотя бы одну комнату"),3===s&&e.selectedRooms.forEach(s=>{let n=e.roomParams[s];n&&n.area||(a["".concat(s,"_area")]="Укажите площадь")}),o(a),0===Object.keys(a).length},[s,e]),C=(0,t.useCallback)(e=>!0,[]),N=(0,t.useCallback)(()=>x(),[x]),g=(0,t.useCallback)(()=>{o({})},[]),y=(0,t.useCallback)(()=>{d(0)},[]),k=(0,t.useCallback)(()=>({1:!0,2:!!e.objectType,3:e.selectedRooms.length>0,4:!0}),[e]);return{formData:e,currentStep:s,errors:c,isSubmitting:i,validationAttempts:r,updateFormData:m,updateRoomParams:u,toggleRoom:h,selectAllRooms:b,resetRoomParams:p,nextStep:v,prevStep:D,goToStep:j,canProceed:(0,t.useCallback)(()=>x(),[x]),validateCurrentStep:x,validateAllSteps:N,clearErrors:g,setSubmitting:l,resetValidationAttempts:y,getStepAccessibility:k}}(),[g,y]=(0,t.useState)(null),k=async()=>{if(!x()){y({type:"error",message:"Пожалуйста, заполните все обязательные поля"}),setTimeout(()=>y(null),5e3);return}C(!0);try{let a=await r(e);a.success?(y({type:"success",message:a.message||"Техническое задание успешно отправлено!"}),setTimeout(()=>window.location.reload(),3e3)):(y({type:"error",message:a.message||"Произошла ошибка при отправке. Попробуйте еще раз."}),C(!1),setTimeout(()=>y(null),5e3))}catch(e){y({type:"error",message:"Произошла ошибка при отправке. Попробуйте еще раз или свяжитесь с нами напрямую."}),C(!1),setTimeout(()=>y(null),5e3)}},f=N();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"main-container",children:[(0,n.jsx)("div",{className:"steps-container",children:[{id:1,title:"Тип объекта"},{id:2,title:"Помещения"},{id:3,title:"Параметры"},{id:4,title:"Экспликация"}].map(e=>(0,n.jsx)("div",{className:"step ".concat(a===e.id?"active":""," ").concat(f[e.id]?"":"disabled"),onClick:()=>f[e.id]&&j&&j(e.id),style:{cursor:f[e.id]?"pointer":"not-allowed",opacity:f[e.id]?1:.5},children:e.title},e.id))}),(0,n.jsxs)("div",{className:"content-grid",children:[1===a&&(0,n.jsxs)("div",{className:"content-section form-step active",children:[(0,n.jsx)("div",{className:"section-header",children:(0,n.jsx)("div",{className:"section-title",children:"Тип объекта"})}),(0,n.jsx)("div",{className:"rooms-grid",children:d.map(a=>(0,n.jsxs)("div",{className:"room-card ".concat(e.objectType===a.id?"selected":""),onClick:()=>i({objectType:a.id}),children:[(0,n.jsx)("div",{className:"room-icon",children:a.icon}),(0,n.jsx)("div",{className:"room-name",children:a.name}),(0,n.jsx)("div",{className:"room-area",children:a.description})]},a.id))}),(0,n.jsxs)("div",{className:"param-row",style:{marginTop:"16px"},children:[(0,n.jsxs)("div",{className:"param-group",children:[(0,n.jsxs)("label",{className:"param-label",children:["Общая площадь (м\xb2) ",(0,n.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,n.jsx)("input",{type:"number",className:"param-input",placeholder:"65",value:e.totalArea,onChange:e=>i({totalArea:e.target.value}),min:"0.1",step:"0.1"})]}),(0,n.jsxs)("div",{className:"param-group",children:[(0,n.jsxs)("label",{className:"param-label",children:["Количество комнат ",(0,n.jsx)("span",{style:{color:"red"},children:"*"})]}),(0,n.jsx)("input",{type:"number",className:"param-input",placeholder:"3",value:e.roomsCount,onChange:e=>i({roomsCount:e.target.value}),min:"1"})]})]}),(0,n.jsx)("div",{className:"summary-actions",children:(0,n.jsx)("button",{className:"btn btn-primary",onClick:v,children:"Далее"})})]}),2===a&&(0,n.jsxs)("div",{className:"content-section form-step active",children:[(0,n.jsxs)("div",{className:"section-header",children:[(0,n.jsx)("div",{className:"section-title",children:"Помещения для экспликации"}),(0,n.jsx)("div",{className:"section-actions",children:(0,n.jsx)("button",{className:"btn btn-secondary",onClick:b,children:"Выбрать все"})})]}),(0,n.jsx)("div",{className:"rooms-grid",children:m.map(a=>{let s=e.selectedRooms.includes(a.id),t=!s&&e.selectedRooms.length>=parseInt(e.roomsCount);return(0,n.jsxs)("div",{className:"room-card ".concat(s?"selected":""," ").concat(t?"disabled":""),onClick:()=>!t&&h(a.id),style:{cursor:t?"not-allowed":"pointer",opacity:t?.5:1},children:[(0,n.jsx)("div",{className:"room-icon",children:a.icon}),(0,n.jsx)("div",{className:"room-name",children:a.name}),(0,n.jsx)("div",{className:"room-area",children:"— м\xb2"})]},a.id)})}),(0,n.jsxs)("div",{className:"summary-actions",children:[(0,n.jsx)("button",{className:"btn btn-secondary",onClick:D,children:"Назад"}),(0,n.jsx)("button",{className:"btn btn-primary",onClick:v,children:"Далее"})]})]}),3===a&&(0,n.jsxs)("div",{className:"content-section form-step active",children:[(0,n.jsxs)("div",{className:"section-header",children:[(0,n.jsx)("div",{className:"section-title",children:"Параметры помещений"}),(0,n.jsx)("div",{className:"section-actions",children:(0,n.jsx)("button",{className:"btn btn-secondary",onClick:p,children:"Сбросить все"})})]}),(0,n.jsx)("div",{className:"rooms-params-list",children:e.selectedRooms.map((a,s)=>{var t,c;return(0,n.jsxs)("div",{className:"room-params-card",children:[(0,n.jsx)("div",{className:"room-params-header",children:(0,n.jsxs)("h3",{className:"room-params-title",children:[s+1,". ",u[a]||a]})}),(0,n.jsxs)("div",{className:"param-row",children:[(0,n.jsxs)("div",{className:"param-group",children:[(0,n.jsx)("label",{className:"param-label",children:"Площадь (м\xb2)"}),(0,n.jsx)("input",{type:"number",className:"param-input",placeholder:"18.5",value:(null===(t=e.roomParams[a])||void 0===t?void 0:t.area)||"",onChange:e=>l(a,"area",e.target.value),min:"0.1",step:"0.1"})]}),(0,n.jsxs)("div",{className:"param-group",children:[(0,n.jsx)("label",{className:"param-label",children:"Высота (м)"}),(0,n.jsx)("input",{type:"number",className:"param-input",placeholder:"2.7",value:(null===(c=e.roomParams[a])||void 0===c?void 0:c.height)||"",onChange:e=>l(a,"height",e.target.value),min:"0.1",step:"0.1"})]})]})]},a)})}),(0,n.jsxs)("div",{className:"summary-actions",children:[(0,n.jsx)("button",{className:"btn btn-secondary",onClick:D,children:"Назад"}),(0,n.jsx)("button",{className:"btn btn-primary",onClick:v,children:"Далее"})]})]}),4===a&&(0,n.jsxs)("div",{className:"content-section form-step active",children:[(0,n.jsx)("div",{className:"section-header",children:(0,n.jsx)("div",{className:"section-title",children:"Экспликация помещений"})}),(0,n.jsxs)("div",{className:"explanation-summary",children:[(0,n.jsxs)("div",{className:"summary-header",children:[(0,n.jsx)("span",{children:"Сводка по ГОСТ 21.501-2018"}),(0,n.jsxs)("span",{children:["Общая площадь:"," ",e.selectedRooms.reduce((a,s)=>{var n;let t=Number(null!==(n=(e.roomParams[s]||{}).area)&&void 0!==n?n:0);return a+(Number.isNaN(t)?0:t)},0).toFixed(1)," ","м\xb2"]})]}),(0,n.jsx)("div",{className:"summary-items",children:e.selectedRooms.map(a=>{let s=e.roomParams[a]||{};return(0,n.jsxs)("div",{className:"summary-item",children:[(0,n.jsx)("span",{children:u[a]||a}),(0,n.jsxs)("span",{children:[s.area||"0.0"," м\xb2"]})]},a)})})]}),(0,n.jsxs)("div",{className:"summary-actions",children:[(0,n.jsx)("button",{className:"btn btn-secondary",onClick:D,children:"Назад"}),(0,n.jsx)("button",{className:"btn btn-primary",onClick:k,disabled:c,children:c?"Отправка...":"Завершить"})]})]})]})]}),g&&(0,n.jsx)("div",{className:"notification ".concat(g.type),children:g.message}),c&&(0,n.jsx)("div",{className:"loading-overlay",children:(0,n.jsxs)("div",{className:"loading-content",children:[(0,n.jsx)("div",{className:"loading-spinner"}),(0,n.jsx)("p",{children:"Отправка данных..."})]})})]})}},9419:function(){}},function(e){e.O(0,[829,971,117,744],function(){return e(e.s=3215)}),_N_E=e.O()}]);